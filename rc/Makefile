# $OpenXM: OpenXM/rc/Makefile,v 1.5 2000/01/30 23:47:40 takayama Exp $
# make repl
# make all
# make install  [ INSTALL_DIR=/home/hoge/bin ]  ; Default is /usr/local/bin
CC=gcc
SHELL_SCRIPTS=asir sm1 gp k0 oxmath oxMathematica
INSTALL_DIR=/usr/local/bin

all :  dot.bashrc  dot.cshrc  openxm  .done_gen-shell-scripts

dot.bashrc : bashrc repl 
	rm -f dot.bashrc 
	echo "# DO NOT EDIT THIS FILE" >dot.bashrc
	./repl <bashrc >>dot.bashrc

dot.cshrc : cshrc repl
	rm -f dot.cshrc 
	echo "# DO NOT EDIT THIS FILE" >dot.cshrc
	./repl <cshrc >>dot.cshrc

repl : repl.c
	${CC} -static -o repl repl.c

openxm : dot.cshrc
	rm -f openxm
	echo "#!/bin/csh" >openxm
	cat dot.cshrc >>openxm
	echo 'exec $$*' >>openxm
	chmod +x openxm
	cp -f openxm ../bin

.done_gen-shell-scripts : dot.cshrc Makefile gen-shell-scripts
	./gen-shell-scripts
	touch .done_gen-shell-scripts

install : all
	cp -f $(SHELL_SCRIPTS) ${INSTALL_DIR}

clean :
	rm -f dot.bashrc dot.cshrc repl openxm $(SHELL_SCRIPTS) .gen-shell-scripts

