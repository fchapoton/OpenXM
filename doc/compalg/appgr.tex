\chapter{グレブナ基底の応用}

グレブナ基底は消去法以外にもさまざまな応用を持つ. 本節では, それらのい
くつかについて解説する.

\begin{nt}
以下で, 次のような記法を用いる. \\
$K$ : 体.\\
$X$ = $\{x_1,\cdots,x_n\}$ : 不定元\\
$R$ : $K[X]$\\
$T$ : $R$ の項全体\\
$HT_<(f)$ : $f$ の $<$ に関する頭項.\\
$HC_<(f)$ : $f$ の $<$ に関する頭係数.\\
$GB_<(S)$ : $S$ の $<$ に関する被約グレブナ基底.\\
$NF_<(f,G)$ : $f$ の $G$ に関する正規形の一つ. $G$ がグレブナ基底ならば一意的
に定まる.
\end{nt}

\section{イデアルに関する演算}

\begin{pr}(イデアルの相等)\\
イデアル $I, J \subset R$ に関し
$I = J \Leftrightarrow GB(I) = GB(J).$ 
\end{pr}

\begin{pr} (イデアルを法とする合同, メンバシップ)\\
イデアル $I$, $f, g\in R$ に関し
$f \equiv g \bmod I \Leftrightarrow NF(f,GB(I)) = NF(g,GB(I)).$ 
特に 
$f \in I \Leftrightarrow NF(f,GB(I)) = 0.$ 
\end{pr}

\begin{pr}(自明なイデアル)\\
イデアル $I \subset R$ に関し
$I = R \Leftrightarrow GB(I) = \{1\}.$
\end{pr}

\begin{pr}(elimination イデアル)\\
$I$ をイデアルとする. 
$X = (X \setminus U) \cup U$ とし, この分割により
すべての $u \in T(U)$, すべての $x \in T(X \setminus U)$ に対し $u < x$ なる 
order $<$ を用いると, 
$GB(I \cap K[U]) = GB(I) \cap K[U]$
\end{pr}
\proof
$f \in J=I \cap K[U]$ とする. $f \in I$ よりある $g \in GB(I)$ が存在して 
$HT(g) \mid HT(f)$. $HT(f) \in T(U)$より $HT(g) \in T(U)$.  ここで, $<$ 
の性質より, $HT(g) \in T(U)$ ならば $g \in K[U]$. よって $g \in GB(I) \cap
K[U]$ で, $GB(I) \cap K[U]$ は $J$ のグレブナ基底. \qed

\begin{pr} (イデアルの交わり)
$I = Id(f_1,\cdots,f_l)$, $J = Id(g_1,\cdots,g_m)$ とすると, 
$I\cap J = (yIR[y] + (1-y)JR[y])\cap R$
\end{pr}
\proof $f \in I\cap J$ とすると, $f = yf+(1-y)f \in (yI + (1-y)J)\cap R$.
逆に $f=yg + (1-y)h$ ($g \in IR[y], h \in JR[y]$) とし, $f \in R$
とする. この時, $y=0$ を代入して, $f = h|_{y=0} \in J$. $y=1$ を
代入して, $f=g|_{y=1} \in I$ より OK. \qed

\begin{co}
\label{intersect}
$I=Id(f_1,\cdots,f_m)$, $J=Id(g_1,\cdots,g_l)$ に対し
$GB(I\cap J) = GB(\{yf_1,\cdots,yf_m,(1-y)g_1,\cdots,(1-y)g_l\}) \cap R$
により $I\cap J$ が計算できる. (左辺は $X < y$ なる 
elimination order で計算する. )
\end{co}

\begin{df} (イデアル商)
イデアル $I$, $R$ の部分集合 $S$ に対し, イデアル商 $I:S$ を
$$I:S = \{f \in R \mid fS \subset I\}$$
で定義する. $J=Id(S)$ とすれば, $I:S = I:J$ で, 
$J=Id(f_1,\cdots,f_m)$ ならば, 
$$I:S = \bigcap_{i=1}^m I:Id(f_i)$$
\end{df}

\begin{pr}
$I:Id(f) = {1\over f}(I \cap Id(f))$
\end{pr}
\proof $g \in I:Id(f)$ ならば $gf \in I$ より $gf \in I \cap Id(f)$.
よって, $g \in {1 \over f}(I \cap Id(f))$.\\
逆に, $g \in {1\over f}(I \cap Id(f))$ ならば $gf \in I \cap Id(f)$ より
$g \in I:Id(f)$. \qed

\begin{co}
$I \cap Id(f)$ の生成元が求まれば, それらは $f$ を因子に持つので, それ
ぞれ $f$ で割ることにより $I:Id(f)$ が求まる. 一般の場合 $I:S$ はそれ
らの交わりとなるが, $I \cap Id(f)$ を含めてイデアルの交わりの計算は系
\ref{intersect} により計算できるので, イデアル商も計算できることに
なる.
\end{co}

\begin{df} (saturation)\\
$I$ をイデアル, $f\in R$ とすれば, $I:f^i$ はイデアルの増大列だがら, あ
る $s \in \N$ が存在して
$$i\ge s \Rightarrow I:f^i = I:f^s$$
が成り立つ. このとき
$$I:f^\infty = I:f^s$$
と定義し, $I$ の $f$ に関する saturation と呼ぶ. 
\end{df}

\begin{pr}
$I$ をイデアル, $f \in R$ に対し, 
$$I:f^\infty = (IR[y]+(1-yf)R[y]) \cap R$$
すなわち $I:f^\infty$ は elimination イデアルにより計算できる. 
\end{pr}
\proof \\
\underline{右辺 $\subset$ 左辺} $g \in$ 右辺とすると, $g = ah+(1-yf)b$ ($a,b \in R[y]$)
と書ける. この式で, $y=1/f$ とおいて, 両辺に $f^d$ ($d$:十分大) を掛ければ
$f^dg \in I$ すなわち $g \in I:f^d$. よって $g \in$ 左辺.\\
\underline{左辺 $\subset$ 右辺} $g \in$ 左辺, すなわちある $d$ に対し $f^dg \in I$ と
する. このとき
$$g \equiv (yf)^d g \equiv 0 \bmod IR[y]+(1-yf)R[y]$$
また, $g \in R$ より $g \in$ 右辺. \qed




%*****************************************************

\section{剰余環, 次元}

\begin{pr}(剰余環の表現)\\
イデアル $I$ に対し, 剰余環 $R/I$ は,正規形を元として定義される代数
構造に同形である．すなわち, $R/I$ は, 元の集合として 
$$\{NF(f,GB(I))\mid f\in R \}$$ と同一視でき, その加法($\oplus$) $\cdot$ 乗法
($\odot$)として次式で定義されるものに同形となる.
$$f\oplus g = NF(f+g,GB(I))$$
$$f\odot g = NF(fg,GB(I))$$
\end{pr}

\begin{pr}(剰余環の線形空間としての基底)\\
\label{mbase}
イデアル $I$ に対し, 剰余環 $R/I$ は $K$-線形空間とみなせるが, 
その線形空間の基底としてイデアルの グレブナ基底に対して正規形である 
項全体がとれる.  すなわち, $R/I$ の基底として 
\begin{center}
$\{ u \in T \mid$ すべての $f \in GB(I)$ に対し $HT(f) {\not|} u \}$
\end{center}
がとれる.
\end{pr}

\begin{df}
$I$ をイデアルとする. $U \subset X$ に対し, $I \cap K[U] = 0$ が成り立
つとき $U$ は independent modulo $I$ という.
\end{df}

\begin{df}(イデアルの次元)\\
イデアル $I$ に対し, イデアルの次元 $\dim(I)$ を
\begin{center}
$\dim(I)$ = $\max(|U| \mid U \subset X$ independent modulo $I)$
\end{center}
で定義する.
\end{df}

\begin{re}(幾何学的意味)
\begin{enumerate}
\item イデアル $I$ の次元は, $K$ の代数閉包上で考えた代数的集合 $V(I)$
の成分の最大次数に等しい. 
\item より一般に, 素イデアルの減少列の長さを用いて環の次元 (Krull 次元) 
が定義され, 上の定義と一致することが示される. 
\end{enumerate}
\end{re}

\begin{df}(Hilbert function)\\
$R=K[X]$ の $s$-次斉次元全体を $R_s$ と書くことにする. イデアル
$I$ に対し, $I_s = I \cap K[X]_s$ と書く. 
斉次イデアル $I$ に対し, $I$ の Hilbert function $H_{R/I}(s)$ を
$$H_{R/I}(s) = \dim_K R_s/I_s$$
で定義する. 
\end{df}

\begin{pr}
$<$ を任意の order とし, $J$ を $I$ の元の頭項で生成されるイデアル
とすると, $H_{R/I}(s) = H_{R/J}(s)$
\end{pr}

\section{消去法}

\begin{df}
イデアル $I$ に対し, $I$ の radical (根基) $\sqrt{I}$ を
\begin{center}
$\sqrt{I} = \{f \in R \mid$ ある $e \in \N$ が存在して $f^e \in I\}$
\end{center}
で定義する. $\sqrt{I}$ もイデアルとなる. 
\end{df}


\begin{df}
$L$ を $K$ の拡大体とし, $V \subset K^n$ とする. このときイデアル $I(V) \subset R$
を
$$I(V) = \{f \in R \mid f|_V=0 \}$$
で定義する. 

\end{df}
次の定理は消去法の基本となる. 

\begin{th}(Nullstellensatz; Hilbert の零点定理)\\
$K$ を体, $\bar{K}$ を $K$ の代数閉包とする. イデアル $I \subset K[X]$
に対し, 
$I(V_{\bar{K}}(I))=\sqrt{I}$
\end{th}

\begin{co}
イデアル $I$, $J$ に対し, 
$V_{\bar{K}}(I)=V_{\bar{K}}(J) \Leftrightarrow \sqrt{I} = \sqrt{J}$
\end{co}

\begin{pr}(0 次元イデアルの性質)\\
代数閉体 $K$ 上の多項式環のイデアル $I$ の零点の個数が有限個 
$\Leftrightarrow$ $R/I$ が $K$ 上有限次元の線形空間
\end{pr}
\proof \\
$\Rightarrow$)
有限個の解を $r_k = (r_{k1}, \cdots, r_{kn})\quad (k = 1,
\cdots, m)$とする. $f_i(x_i) = \prod_k (x_i-r_{ki})$ とおくと,
$f_i(x_i)$ は$I$ の零点上で 0 となるから, Hilbert の零点定理によりあ
る $t$ が存在して $f_i(x_i)^t \in I$.  よって, $GB(I)$ にも, 各 $i$ に
対し, $HT(g)$ が $x_i$ の冪となるものが存在する. すると, 命題 \ref{mbase}
より $R/I$ は $K$ 上有限次元となる.\\
$\Leftarrow$)
各 $i$ に対し, 変数中で $x_i$ が最低の順序になるような辞書式順序をとれば, 
$GB(I)$ 中に, $f_i(x_i)$ なる一変数多項式が存在することがわかる. 
よって, 解は有限個. \qed

変数順序として $x_1 < x_2 < \cdots < x_n$ なる辞書式順序を考えれば, 
イデアル $I$ の零点が有限個の場合は, すべての $i$ に対し, ある 
$f_i \in GB(I) \cap (K[x_1,\cdots,x_i]\setminus K[x_1,\cdots,x_{i-1}])$
が存在する. よって 
$f_1(x_1)$から根 $\alpha_1$ を求め, $f_2(\alpha_1,x_2)$ から根 
$\alpha_2$ を求め, という操作を繰り返せば, $F$ の共通零点をすべて求め
ることができる. 

\section{加群のグレブナ基底}

自由加群 $K[X]^l$ および, その部分加群 $M \subset F$ に
対してもグレブナ基底が定義される. この場合, 項としては, 
$te_i$ ($t \in T(X)$; $e_i = (0,\cdots,1,\cdots,0)$ : 第 $i$ 成分のみ 1) 
をとり, 
\begin{enumerate}
\item すべての $t \in T$, すべての $F$ の項 $m$ に対し $m \le tm$
\item すべての $t \in T$, すべての $F$ の項の組 $m_1, m_2$ に対し
$m_1 \le m_2$ $\Rightarrow$ $tm_1 \le tm_2$
\end{enumerate}
を満たす全順序を入れる. モノイデアル $E(S)$ も同様に定義され, グレブナ
基底も, $E(G)$ が $E(M)$ を生成するものとして定義される. Buchberger ア
ルゴリズムは, $S$-多項式を, 頭項の $F$ における位置が等しい (すなわち,
$HT(a)=t_ae_a$, $HT(b)=t_be_b$ のとき $a=b$)に対して通常の多項式と同様
に定義し, それ以外は 0 と定義すれば全く同様にできる. 加群のグレブナ基
底は, syzygy の計算を通して, 加群の自由分解 (free resolution) を与える. 
これにより, 加群のホモロジーの計算が可能になるが, ここでは述べな
い.

\section{例 : 双対曲線の計算}
elimination イデアルの応用として, 双対曲線の計算の例を示す. 
$f(x_1,x_2) \in \Q[x_1,x_2]$ とし, $F$ の total degree を $d$ とすれば, 
$F(x_0,x_1,x_2)=x_0^df(x_1/x_0,x_2/x_0)$
は $d$ 次同次多項式で, $F$ の定義する代数曲線の双対曲線は, 
$$\left\{
\parbox[c]{8in}{
$u_i={{\partial F}\over {\partial x_i}} (x_0,x_1,x_2)$ $(i=0,1,2)$\\
$F(x_0,x_1,x_2)=0$
}
\right.$$
から $x_0, x_1, x_2$ を消去して得られる. 消去法の一つとしてグレブナ基底
による消去が可能である. 
$$I = Id(
u_0-{{\partial F}\over {\partial x_0}},
u_1-{{\partial F}\over {\partial x_1}},
u_2-{{\partial F}\over {\partial x_2}},
F)$$
とする時, $\{x_0, x_1, x_2\}$ $\succ$ $\{u_0, u_1, u_2\}$ なる任意の消
去順序により $I$ のグレブナ基底 $GB(I)$ を計算すれば, 
$$I \cap \Q[u_0,u_1,u_2] = Id(GB(I) \cap Q[u_0,u_1,u_2]).$$
以下の例で, $V(g_i)$ は $V(f_i)$ の双対曲線である. 

\vskip\baselineskip
$\left\{
\parbox[c]{6in}{
$f_1=x^5-x^3+y^2$\\
$g_1=108x^7-108x^5+1017y^2x^4-16y^4x^3-4250y^2x^2+1800y^4x-108y^6+3125y^2$
}
\right.$

\vskip\baselineskip
$\left\{
\parbox[c]{6in}{
$f_2=x^6+3y^2x^4+(3y^4-4y^2)x^2+y^6$\\
$g_2=-256x^6+(64y^4-192y^2+864)x^4+(-192y^4+1620y^2-729)x^2-256y^6+864y^4-729y^2$
}
\right.$

\vskip\baselineskip
$\left\{
\parbox[c]{6in}{
$f_3=2x^4-3yx^2+y^4-2y^3+y^2$\\
$g_3=-12x^6+(-y^2+178y-37)x^4+(12y^3-768y^2+2208y+4608)x^2-32y^4+1024y^3-7680y^2-8192y-2048$
}
\right.$

\vskip\baselineskip
\begin{figure}[hbtp]
\begin{tabular}{cc}
\begin{minipage}{.5\hsize}
\begin{center}
\epsfxsize=7cm
\epsffile{ps/1.ps}
\end{center}
\caption{$f_1=0$}
\label{f2}
\end{minipage} &

\begin{minipage}{.5\hsize}
\begin{center}
\epsfxsize=7cm
\epsffile{ps/1d.ps}
\end{center}
\caption{$g_1=0$}
\label{g2}
\end{minipage}
\end{tabular}
\end{figure}


\begin{figure}[hbtp]
\begin{tabular}{cc}
\begin{minipage}{.5\hsize}
\begin{center}
\epsfxsize=7cm
\epsffile{ps/2.ps}
\end{center}
\caption{$f_2=0$}
\label{f3}
\end{minipage} &

\begin{minipage}{.5\hsize}
\begin{center}
\epsfxsize=7cm
\epsffile{ps/2d.ps}
\end{center}
\caption{$g_2=0$}
\label{g3}
\end{minipage}
\end{tabular}
\end{figure}

\begin{figure}[hbtp]
\begin{tabular}{cc}
\begin{minipage}{.5\hsize}
\begin{center}
\epsfxsize=7cm
\epsffile{ps/4.ps}
\end{center}
\caption{$f_3=0$}
\label{f5}
\end{minipage} &

\begin{minipage}{.5\hsize}
\begin{center}
\epsfxsize=7cm
\epsffile{ps/4d.ps}
\end{center}
\caption{$g_3=0$}
\label{g5}
\end{minipage}
\end{tabular}
\end{figure}
