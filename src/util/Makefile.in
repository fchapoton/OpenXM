# $OpenXM: OpenXM/src/util/Makefile.in,v 1.8 2009/02/22 15:20:17 ohara Exp $
#OpenXM_ROOT=../../../OpenXM
prefix=@prefix@
exec_prefix=@exec_prefix@
bindir=@bindir@
libdir=@libdir@
includedir=@includedir@

CC=@CC@
CFLAGS=@CFLAGS@ -D_BSD_SOURCE -D_POSIX_C_SOURCE
RANLIB=@RANLIB@

INSTALL = install -c

BIN = oxweave oxreplace oxgentexi oxgreph oxhtmlhelp
LIB = libox_pathfinder.a

all : all-bin all-lib

all-bin: ${BIN}
all-lib: ${LIB}

oxweave : oxweave.o
	${CC} -o $@ oxweave.o

oxreplace : oxreplace.o
	${CC} -o $@ oxreplace.o

oxgentexi : oxgentexi.o
	${CC} -o $@ oxgentexi.o

oxgreph : oxgreph.o
	${CC} -o $@ oxgreph.o

oxhtmlhelp : oxhtmlhelp.o
	${CC} -o $@ oxhtmlhelp.o

libox_pathfinder.a : ox_pathfinder.o
	ar ru libox_pathfinder.a ox_pathfinder.o
	${RANLIB} libox_pathfinder.a

ox_pathfinder.o : ox_pathfinder.h

test: ox_pathfinder.o test.o
	${CC} -o $@ test.o ox_pathfinder.o -L${libdir} -lgc

install-bin: all-bin
	@if [ ! -f ./.install_bin_done ] ; then \
		echo "Installing" ${BIN} "oxfetch.sh md5.sh" ; \
		${INSTALL} lndir.sh oxfetch.sh md5.sh oxsetupdotf.sh ${bindir} ; \
		${INSTALL} -s ${BIN} ${bindir} ; \
		${INSTALL} -s oxweave ${prefix}/src/kxx ; \
		touch ./.install_bin_done ; \
	fi

install-lib: all-lib
	@if [ ! -f ./.install_lib_done ] ; then \
		echo "Installing libox_pathfinder.a, ox_pathfinder.h" ; \
		${INSTALL} libox_pathfinder.a ${libdir}  ; \
		${INSTALL} ox_pathfinder.h ${includedir} ; \
		touch ./.install_lib_done ; \
	fi

install: install-bin install-lib

clean:
	rm -f .install_*_done *.o ${BIN} ${LIB} test
