CC = gcc
INCLUDE = -I ../gmp -I ../Kan
FLAG = -g
all : sample.a sm1Socket.a asirconv.a   cmo.a file2.a ox.a
all0 : ak.a libasir.a

sample.a : sample.h sample.c sample.hh
	$(CC) $(FLAG) $(INCLUDE) -c sample.c
	ar ru sample.a sample.o
	../gc/if_not_there ../gc/on_sparc_sunos5 ranlib sample.a

sm1Socket.a : sm1Socket.h sm1Socket.c sm1Socket.hh
	$(CC) $(FLAG) $(INCLUDE) -c sm1Socket.c
	ar ru sm1Socket.a sm1Socket.o
	../gc/if_not_there ../gc/on_sparc_sunos5 ranlib sm1Socket.a

sm1pvm.a : sm1pvm.h sm1pvm.c sm1pvm.hh
	$(CC) $(FLAG) $(INCLUDE) -I $(PVM_ROOT)/include -c sm1pvm.c
	ar ru sm1pvm.a sm1pvm.o
	../gc/if_not_there ../gc/on_sparc_sunos5 ranlib sm1pvm.a

asirconv.a : asir.h asirconv.c asir.hh
	$(CC) $(FLAG) $(INCLUDE) -c asirconv.c
	ar ru asirconv.a asirconv.o
	../gc/if_not_there ../gc/on_sparc_sunos5 ranlib asirconv.a

ak.a : 
#	ln -s /fuji/taka/noro/ak.a
	ln -s /dosc/work/noro/ak.a

libasir.a :
#	ln -s /fuji/taka/noro/libasir.a
	ln -s /dosc/work/noro/libasir.a

cmo.a : cmo.h cmo.c cmo-gmp.c file2.h mathcap.h cmotag.htmp oxMessageTag.h oxFunctionId.h
	$(CC) $(FLAG) $(INCLUDE) -c cmo.c
	$(CC) $(FLAG) $(INCLUDE) -I ../gmp/mpn -c cmo-gmp.c
	ar ru cmo.a cmo.o cmo-gmp.o
	../gc/if_not_there ../gc/on_sparc_sunos5 ranlib cmo.a

cmotag.htmp : cmotagToName
	touch cmotag.htmp
	/bin/rm  -rf cmotag.htmp
	./cmotagToName >cmotag.htmp

cmotagToName : cmotagToName.c cmotag.h
	$(CC) -o cmotagToName cmotagToName.c

cmo.h : cmo0.h cmotag.h
	/bin/rm -f cmo.h
	echo "/*cmo.h : Dont edit  this file. */" >cmo.h
	cat cmotag.h  >>cmo.h
	echo "/*cmo.h : Dont edit  this file. */" >>cmo.h
	cat cmo0.h >>cmo.h

file2.a : file2.h file2.c
	$(CC) $(FLAG) $(INCLUDE) -c file2.c
	ar ru file2.a file2.o
	../gc/if_not_there ../gc/on_sparc_sunos5 ranlib file2.a

ox.h : ox.a
ox.hh : ox.a

.c.o :
	$(CC) $(FLAG) $(INCLUDE) -c $<
mytcpio.o : mytcpio.c ox_kan.h
oxmisc.o : oxmisc.c ox_kan.h
oxmisc2.o : oxmisc2.c ox_kan.h mathcap.h cmo.h
	$(CC) $(FLAG) $(INCLUDE) -c oxmisc2.c

ox.a : mytcpio.o oxmisc.o oxmisc2.o ox_kan.h oxx.h oxx.hh
	ar ru ox.a mytcpio.o oxmisc.o oxmisc2.o
	../gc/if_not_there ../gc/on_sparc_sunos5 ranlib ox.a
	/bin/rm -f tmp.h
	echo "/*********  DO NOT EDIT THIS FILE *************/" >tmp.h
	cat oxx.h >>tmp.h
	cp tmp.h ox.h
	/bin/rm -f tmp.h
	echo "/*********  DO NOT EDIT THIS FILE *************/" >tmp.h
	cat oxx.hh >>tmp.h
	cp tmp.h ox.hh
	/bin/rm -f tmp.h


ox_kan.h : oxMessageTag.h oxFunctionId.h file2.h cmotag.h oxKan0.h mathcap.h
	/bin/rm -f ox_kan.h
	echo "/* Do not edit this file. */" >ox_kan.h
	cat mathcap.h file2.h cmotag.h oxMessageTag.h oxFunctionId.h  oxKan0.h >>ox_kan.h


clean :
	/bin/rm -f *.a *.o *~ a.out cmotagToName
