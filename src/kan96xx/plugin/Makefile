## $OpenXM: OpenXM/src/kan96xx/plugin/Makefile,v 1.2 1999/11/02 12:28:57 takayama Exp $ 

OPEMXM_CONTRIB=../../../../OpenXM_contrib
GC=$(OPEMXM_CONTRIB)/gc
GMP=$(OPEMXM_CONTRIB)/gmp

AR=/usr/bin/ar
RM=/bin/rm

CC=gcc
CFLAGS+=-g -I$(GMP) -I../Kan

all: asirconv.a cmo.a file2.a ox.a sample.a sm1Socket.a

clean:
	$(RM) -f *.a *.o a.out cmo.h cmotag.hh cmotagToName cmptag.htmp \
		 ox.h ox.hh ox_kan.h

asirconv.a: asirconv.o

asirconv.o: asir.h asir.hh asirconv.c

cmo.a: cmo.o cmo-gmp.o

cmo.o: cmo.h cmo.c cmo-gmp.c file2.h mathcap.h cmotag.htmp \
	oxMessageTag.h oxFunctionId.h

cmo-gmp.o: cmo.h cmo.c cmo-gmp.c file2.h mathcap.h cmotag.htmp \
	oxMessageTag.h oxFunctionId.h
	$(CC) $(CFLAGS) -I$(GMP)/mpn -c cmo-gmp.c

cmotag.htmp: cmotagToName
	$(RM) -f cmotag.htmp
	./cmotagToName > cmotag.htmp

cmotagToName: cmotag.h cmotagToName.c
	$(CC) -o cmotagToName cmotagToName.c

cmo.h: cmo0.h cmotag.h
	@echo "Making cmo.h"
	@$(RM) -f cmo.h
	@echo "/********* DO NOT EDIT THIS FILE *************/" > cmo.h
	@cat cmotag.h cmo0.h >> cmo.h

file2.a: file2.o

file2.o: file2.h file2.c

ox.a: mytcpio.o oxmisc.o oxmisc2.o

ox.h: oxx.h
	@echo "Making ox.h"
	@echo "/********* DO NOT EDIT THIS FILE *************/" > ox.h
	@cat oxx.h >> ox.h

ox.hh: oxx.hh
	@echo "Making ox.hh"
	@$(RM) -f ox.hh
	@echo "/********* DO NOT EDIT THIS FILE *************/" > ox.hh
	@cat oxx.hh >> ox.hh


ox_kan.h: cmotag.h file2.h mathcap.h oxFunctionId.h oxMessageTag.h oxKan0.h
	@echo "Making ox_kan.h"
	@$(RM) -f ox_kan.h
	@echo "/********* DO NOT EDIT THIS FILE *************/" > ox_kan.h
	@cat mathcap.h file2.h cmotag.h oxMessageTag.h oxFunctionId.h \
	    oxKan0.h >> ox_kan.h

mytcpio.o: ox.h ox.hh ox_kan.h mytcpio.c
oxmisc.o: ox.h ox.hh ox_kan.h oxmisc.c
oxmisc2.o: cmo.h mathcap.h ox.h ox.hh ox_kan.h oxmisc2.c

sample.a: sample.o

sample.o: sample.h sample.hh sample.c

sm1Socket.a: sm1Socket.o

sm1Socket.o: sm1Socket.h sm1Socket.hh sm1Socket.c

sm1pvm.a: sm1pvm.o

sm1pvm.o: sm1pvm.h sm1pvm.hh sm1pvm.c
	$(CC) $(CFLAGS) -I $(PVM_ROOT)/include -c sm1pvm.c

all0: ak.a libasir.a

ak.a:
#	ln -s /fuji/taka/noro/ak.a
	ln -s /dosc/work/noro/ak.a

libasir.a:
#	ln -s /fuji/taka/noro/libasir.a
	ln -s /dosc/work/noro/libasir.a

.c.o:
	$(CC) $(CFLAGS) -c $<

.o.a:
	$(AR) ru $@ $?
	$(GC)/if_not_there $(GC)/on_sparc_sunos5 ranlib $@
